# æ•°æ®æµè¯´æ˜ - è¾“å…¥è¾“å‡ºå®Œå…¨æœ¬åœ°åŒ–

## ğŸ“Š å®Œæ•´æ•°æ®æµå›¾

```
å®¿ä¸»æœºï¼ˆä½ çš„æœ¬åœ°æœåŠ¡å™¨ï¼‰                     Dockerå®¹å™¨ï¼ˆä¸´æ—¶è®¡ç®—ç¯å¢ƒï¼‰
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /your/project/input/       â”‚  â”€â”€â”€â”€æ˜ å°„(åªè¯»)â”€â”€â”€â”€>  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    protein.json             â”‚                      â”‚ /input/     â”‚
â”‚    (ä½ çš„è¾“å…¥æ–‡ä»¶)            â”‚  <â”€â”€â”€â”€è¯»å–â”€â”€â”€â”€â”€â”€â”€â”€    â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚  /mnt/nvme/share/           â”‚  â”€â”€â”€â”€æ˜ å°„(åªè¯»)â”€â”€â”€â”€>  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    msa_datasets/            â”‚                      â”‚ /msa/         â”‚
â”‚    (MSAæ•°æ®åº“)               â”‚  <â”€â”€â”€â”€æŸ¥è¯¢â”€â”€â”€â”€â”€â”€â”€â”€    â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚  /mnt/nvme/share/ckpt/      â”‚  â”€â”€â”€â”€æ˜ å°„(åªè¯»)â”€â”€â”€â”€>  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    HelixFold3.pdparams      â”‚                      â”‚ /ckpt/        â”‚
â”‚    (æ¨¡å‹æƒé‡)                â”‚  <â”€â”€â”€â”€åŠ è½½â”€â”€â”€â”€â”€â”€â”€â”€    â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                             â”‚
                                                             â–¼
                                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                      â”‚  æ¨ç†è®¡ç®—    â”‚
                                                      â”‚  inference.pyâ”‚
                                                      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚  /your/project/output/      â”‚  <â”€â”€â”€â”€å†™å…¥â”€â”€â”€â”€â”€â”€â”€â”€    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    predicted_structures/    â”‚                      â”‚ /output/      â”‚
â”‚    final_features.pkl       â”‚  â”€â”€â”€â”€æ˜ å°„(å¯å†™)â”€â”€â”€â”€>  â”‚               â”‚
â”‚    (æ¨ç†ç»“æœ)                â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                    å®¹å™¨è¿è¡Œç»“æŸï¼Œè‡ªåŠ¨åˆ é™¤ Ã—
                                    ä½†æ•°æ®ä¿ç•™åœ¨å®¿ä¸»æœº âœ“
```

## ğŸ¯ å…³é”®ç†è§£

### 1. è¾“å…¥æ–‡ä»¶ï¼ˆå®Œå…¨æœ¬åœ°ï¼‰

**ä½ çš„æ“ä½œï¼š**
```bash
# ä½ åœ¨æœ¬åœ°å‡†å¤‡è¾“å…¥æ–‡ä»¶
/home/user/my_project/inputs/protein_a.json
/home/user/my_project/inputs/protein_b.json
```

**è¿è¡Œæ¨ç†ï¼š**
```bash
bash run_docker_infer_custom.sh \
    -i /home/user/my_project/inputs/protein_a.json \
    -o /home/user/my_project/outputs
```

**Dockeråšçš„äº‹æƒ…ï¼š**
```bash
# Dockerè‡ªåŠ¨æ˜ å°„
å®¿ä¸»æœº: /home/user/my_project/inputs/  â†’  å®¹å™¨: /input/
# å®¹å™¨å†…ç¨‹åºè¯»å– /input/protein_a.json
# å®é™…è¯»å–çš„æ˜¯å®¿ä¸»æœºçš„ /home/user/my_project/inputs/protein_a.json
```

### 2. è¾“å‡ºç»“æœï¼ˆç›´æ¥å†™å…¥æœ¬åœ°ï¼‰

**Dockeråšçš„äº‹æƒ…ï¼š**
```bash
# Dockerè‡ªåŠ¨æ˜ å°„
å®¿ä¸»æœº: /home/user/my_project/outputs/  â†  å®¹å™¨: /output/
# å®¹å™¨å†…ç¨‹åºå†™å…¥ /output/protein_a/...
# å®é™…å†™å…¥å®¿ä¸»æœºçš„ /home/user/my_project/outputs/protein_a/...
```

**ç»“æœï¼š**
```bash
# æ¨ç†å®Œæˆåï¼Œä½ å¯ä»¥åœ¨æœ¬åœ°çœ‹åˆ°
/home/user/my_project/outputs/
â””â”€â”€ protein_a/
    â”œâ”€â”€ final_features.pkl
    â”œâ”€â”€ predicted_structures/
    â”‚   â”œâ”€â”€ model_0.cif
    â”‚   â”œâ”€â”€ model_1.cif
    â”‚   â””â”€â”€ ...
    â””â”€â”€ ...
```

## ğŸ”„ å®Œæ•´æµç¨‹ç¤ºä¾‹

### åœºæ™¯ï¼šé¢„æµ‹ä¸€ä¸ªæ–°çš„è›‹ç™½è´¨å¤åˆç‰©

**æ­¥éª¤1: å‡†å¤‡è¾“å…¥**
```bash
# ä½ åœ¨æœ¬åœ°åˆ›å»ºè¾“å…¥æ–‡ä»¶
/data/my_research/proteins/complex_001.json
```

**æ­¥éª¤2: è¿è¡Œæ¨ç†**
```bash
bash run_docker_infer_custom.sh \
    -i /data/my_research/proteins/complex_001.json \
    -o /data/my_research/results \
    -n 10
```

**æ­¥éª¤3: Dockerå†…éƒ¨å‘ç”Ÿçš„äº‹æƒ…**
```
1. å¯åŠ¨å®¹å™¨
2. æ˜ å°„ç›®å½•ï¼š
   /data/my_research/proteins/ â†’ /input/
   /data/my_research/results/  â†’ /output/
   /mnt/nvme/share/msa_datasets/ â†’ /msa/
   /mnt/nvme/share/ckpt/ â†’ /ckpt/
3. è¿è¡Œ inference.py
   - è¯»å– /input/complex_001.json (å®é™…: å®¿ä¸»æœºæ–‡ä»¶)
   - æŸ¥è¯¢ /msa/ (å®é™…: å®¿ä¸»æœºæ•°æ®åº“)
   - åŠ è½½ /ckpt/æ¨¡å‹ (å®é™…: å®¿ä¸»æœºæƒé‡)
   - è®¡ç®—...
   - å†™å…¥ /output/ (å®é™…: å†™åˆ°å®¿ä¸»æœº)
4. å®¹å™¨é€€å‡ºå¹¶åˆ é™¤
```

**æ­¥éª¤4: æŸ¥çœ‹ç»“æœ**
```bash
# ç»“æœå·²ç»åœ¨ä½ çš„æœ¬åœ°ç›®å½•
ls /data/my_research/results/complex_001/
```

## ğŸ“ ç›®å½•æ˜ å°„å¯¹ç…§è¡¨

| å®¿ä¸»æœºè·¯å¾„ | å®¹å™¨å†…è·¯å¾„ | æƒé™ | è¯´æ˜ |
|-----------|-----------|------|------|
| ä½ çš„è¾“å…¥æ–‡ä»¶æ‰€åœ¨ç›®å½• | `/input/` | åªè¯»(ro) | è‡ªåŠ¨æ ¹æ®è¾“å…¥æ–‡ä»¶ç¡®å®š |
| ä½ çš„è¾“å‡ºç›®å½• | `/output/` | è¯»å†™ | å‘½ä»¤è¡Œ `-o` å‚æ•°æŒ‡å®š |
| `/mnt/nvme/share/msa_datasets/` | `/msa/` | åªè¯»(ro) | MSAæ•°æ®åº“ï¼ˆå›ºå®šï¼‰ |
| `/mnt/nvme/share/ckpt/` | `/ckpt/` | åªè¯»(ro) | æ¨¡å‹æƒé‡ï¼ˆå›ºå®šï¼‰ |

## âœ… éªŒè¯è¾“å…¥è¾“å‡ºæœ¬åœ°åŒ–

### æµ‹è¯•1: æ£€æŸ¥è¾“å…¥æ¥è‡ªæœ¬åœ°

```bash
# 1. åˆ›å»ºä¸€ä¸ªæµ‹è¯•è¾“å…¥æ–‡ä»¶
echo '{"test": "data"}' > /tmp/test_input.json

# 2. è¿è¡Œæ¨ç†ï¼ˆä¼šå¤±è´¥ï¼Œä½†èƒ½éªŒè¯è·¯å¾„ï¼‰
bash run_docker_infer_custom.sh -i /tmp/test_input.json -o /tmp/test_output

# 3. å®¹å™¨ä¼šå°è¯•è¯»å–ä½ æœ¬åœ°çš„ /tmp/test_input.json
```

### æµ‹è¯•2: æ£€æŸ¥è¾“å‡ºä¿å­˜åˆ°æœ¬åœ°

```bash
# 1. æŒ‡å®šè¾“å‡ºç›®å½•
OUTPUT_DIR="/tmp/my_inference_$(date +%s)"

# 2. è¿è¡Œæ¨ç†
bash run_docker_infer_custom.sh -i ./data/demo.json -o "$OUTPUT_DIR" -n 1

# 3. æ£€æŸ¥è¾“å‡ºæ–‡ä»¶ï¼ˆåœ¨ä½ çš„æœ¬åœ°ï¼‰
ls -lh "$OUTPUT_DIR"
# ä½ ä¼šçœ‹åˆ°ç»“æœæ–‡ä»¶ï¼Œè¯æ˜æ˜¯å†™å…¥æœ¬åœ°çš„
```

## ğŸš« å¸¸è§è¯¯è§£æ¾„æ¸…

### è¯¯è§£1: "æ•°æ®åœ¨å®¹å™¨å†…"
âŒ **é”™è¯¯**ï¼šæ•°æ®ä¿å­˜åœ¨å®¹å™¨å†…ï¼Œéœ€è¦ç”¨ `docker cp` å¤åˆ¶å‡ºæ¥
âœ… **æ­£ç¡®**ï¼šæ•°æ®å§‹ç»ˆåœ¨æœ¬åœ°ï¼Œå®¹å™¨åªæ˜¯å€Ÿç”¨æœ¬åœ°ç›®å½•

### è¯¯è§£2: "éœ€è¦æŠŠæ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨"
âŒ **é”™è¯¯**ï¼šå…ˆæŠŠè¾“å…¥æ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨å†…ï¼Œå†è¿è¡Œæ¨ç†
âœ… **æ­£ç¡®**ï¼šç›´æ¥æŒ‡å®šæœ¬åœ°æ–‡ä»¶è·¯å¾„ï¼ŒDockerè‡ªåŠ¨æ˜ å°„

### è¯¯è§£3: "å®¹å™¨å†…æœ‰é¢„ç½®çš„è¾“å…¥æ–‡ä»¶"
âŒ **é”™è¯¯**ï¼šä½¿ç”¨å®¹å™¨å†…çš„ç¤ºä¾‹æ–‡ä»¶
âœ… **æ­£ç¡®**ï¼šå®¹å™¨å†…ç¤ºä¾‹æ–‡ä»¶åªæ˜¯æµ‹è¯•ç”¨ï¼Œä½ ç”¨è‡ªå·±æœ¬åœ°çš„æ–‡ä»¶

### è¯¯è§£4: "è¾“å‡ºç›®å½•å¿…é¡»åœ¨é¡¹ç›®ç›®å½•ä¸‹"
âŒ **é”™è¯¯**ï¼šè¾“å‡ºåªèƒ½åœ¨ `./output`
âœ… **æ­£ç¡®**ï¼šè¾“å‡ºå¯ä»¥åœ¨ä»»ä½•æœ¬åœ°ç›®å½•ï¼Œå¦‚ `/data/results/`, `/home/user/outputs/` ç­‰

## ğŸ“ å®é™…ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: ç ”ç©¶é¡¹ç›®

```bash
# ä½ çš„é¡¹ç›®ç»“æ„ï¼ˆå®Œå…¨æœ¬åœ°ï¼‰
/home/user/research/
â”œâ”€â”€ raw_sequences/
â”‚   â”œâ”€â”€ seq_001.json
â”‚   â”œâ”€â”€ seq_002.json
â”‚   â””â”€â”€ seq_003.json
â””â”€â”€ predictions/
    â””â”€â”€ (æ¨ç†ç»“æœå°†ä¿å­˜åœ¨è¿™é‡Œ)

# æ‰¹é‡æ¨ç†
for seq in /home/user/research/raw_sequences/*.json; do
    bash run_docker_infer_custom.sh \
        -i "$seq" \
        -o /home/user/research/predictions \
        -n 5
done
```

### åœºæ™¯2: åä½œé¡¹ç›®

```bash
# å›¢é˜Ÿå…±äº«ç›®å½•ï¼ˆNFS/å…±äº«ç›˜ï¼‰
/shared/team_project/
â”œâ”€â”€ inputs/          # å›¢é˜Ÿæˆå‘˜æ”¾å…¥çš„è›‹ç™½è´¨åºåˆ—
â””â”€â”€ results/         # æ¨ç†ç»“æœ

# ä»»ä½•äººéƒ½å¯ä»¥è¿è¡Œ
bash run_docker_infer_custom.sh \
    -i /shared/team_project/inputs/protein_new.json \
    -o /shared/team_project/results \
    -n 10
```

### åœºæ™¯3: ä¸´æ—¶æµ‹è¯•

```bash
# å¿«é€Ÿæµ‹è¯•ä¸€ä¸ªæ–°åºåˆ—
bash run_docker_infer_custom.sh \
    -i /tmp/quick_test.json \
    -o /tmp/test_results \
    -n 1

# æŸ¥çœ‹ç»“æœ
ls /tmp/test_results/

# ç»“æœä¸æ»¡æ„ï¼Ÿç›´æ¥åˆ é™¤
rm -rf /tmp/test_results

# å®¹å™¨æ—©å·²åˆ é™¤ï¼Œæ²¡æœ‰ä»»ä½•é—ç•™
```

## ğŸ’¡ æ ¸å¿ƒåŸåˆ™

1. **æ‰€æœ‰ç”¨æˆ·æ•°æ®éƒ½åœ¨å®¿ä¸»æœºæœ¬åœ°**
2. **å®¹å™¨æ˜¯æ— çŠ¶æ€çš„è®¡ç®—ç¯å¢ƒ**
3. **å®¹å™¨åˆ é™¤åï¼Œä½ çš„æ•°æ®å®Œå¥½æ— æŸ**
4. **å¯ä»¥ä½¿ç”¨ä»»æ„æœ¬åœ°è·¯å¾„ä½œä¸ºè¾“å…¥è¾“å‡º**
5. **ä¸éœ€è¦è¿›å…¥å®¹å™¨ã€å¤åˆ¶æ–‡ä»¶æˆ–ä¿®æ”¹å®¹å™¨å†…é…ç½®**
